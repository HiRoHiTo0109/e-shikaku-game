<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Eè³‡æ ¼ æ”»ç•¥ã®å¡”</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=DotGothic16&display=swap');

        :root {
            /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¤‰æ•°ï¼ˆPCç”¨ï¼‰ */
            --bg-color: #050505;
            --win-bg: #111;
            --text-color: #e0e0e0;
            --accent-color: #4db8ff;
            --base-font-size: 16px;
            --btn-padding: 12px;
            --window-width: 750px;
            --border-width: 4px;
        }

        /* === ã‚¹ãƒãƒ›ç”¨è¨­å®š (ç”»é¢å¹…600pxä»¥ä¸‹) === */
        @media (max-width: 600px) {
            :root {
                --base-font-size: 18px; /* æ–‡å­—ã‚’å¤§ãã */
                --btn-padding: 20px;    /* ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã‚„ã™ã */
                --window-width: 100%;   /* æ¨ªå¹…ã„ã£ã±ã„ã« */
                --border-width: 0px;    /* ä½™è¨ˆãªæ ç·šã‚’æ¶ˆã™ */
            }
            .game-window {
                height: 100dvh; /* ç”»é¢ã®é«˜ã•ã„ã£ã±ã„ã« */
                border-radius: 0 !important;
            }
            .battle-scene {
                flex-basis: 40%; /* ãƒãƒˆãƒ«ç”»é¢ã®æ¯”ç‡èª¿æ•´ */
            }
            .command-area {
                flex-basis: 60%; /* æ“ä½œã‚¨ãƒªã‚¢ã‚’åºƒãã¨ã‚‹ */
                padding-bottom: 40px !important; /* ä¸‹éƒ¨ã®èª¤æ“ä½œé˜²æ­¢ */
            }
            .quiz-grid {
                gap: 15px !important; /* ãƒœã‚¿ãƒ³ã®é–“éš”ã‚’åºƒã’ã‚‹ */
            }
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'DotGothic16', sans-serif;
            font-size: var(--base-font-size);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠé˜²æ­¢ */
            -webkit-tap-highlight-color: transparent; /* ã‚¿ãƒƒãƒ—æ™‚ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆæ¶ˆå» */
        }

        .game-window {
            width: var(--window-width);
            max-width: 750px;
            border: var(--border-width) solid #444;
            background-color: var(--win-bg);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.8);
            position: relative;
            display: flex;
            flex-direction: column;
            border-radius: 8px;
            overflow: hidden;
        }

        .header-info {
            background: #222;
            padding: 8px 15px;
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            border-bottom: 1px solid #555;
            color: #aaa;
        }

        .battle-scene {
            height: 300px; /* PCã§ã®åŸºæº–é«˜ã• */
            background: radial-gradient(circle at bottom, #223, #000);
            position: relative;
            display: flex;
            flex-direction: column;
            padding: 10px;
        }

        /* æ•µã‚¨ãƒªã‚¢ */
        .enemy-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2;
        }
        .enemy-sprite {
            font-size: clamp(80px, 20vw, 120px); /* ç”»é¢ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦å¯å¤‰ */
            filter: drop-shadow(0 0 20px rgba(255, 50, 50, 0.3));
            transition: transform 0.1s;
            margin-bottom: 5px;
        }
        .enemy-name { font-size: 1.2rem; color: #ff8888; margin-bottom: 5px; text-shadow: 2px 2px 0 #000; }

        /* HPãƒãƒ¼å…±é€š */
        .hp-container { width: 80%; max-width: 240px; margin: 0 auto; background: #000; border: 2px solid #666; border-radius: 4px; padding: 2px; }
        .hp-bar { height: 10px; width: 100%; transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .hp-red { background: linear-gradient(to right, #f00, #900); }
        .hp-green { background: linear-gradient(to right, #0f0, #090); }

        /* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¨ãƒªã‚¢ */
        .player-area {
            margin-top: auto;
            background: rgba(0,0,0,0.6);
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #444;
            z-index: 2;
        }
        .player-stats { display: flex; justify-content: space-between; align-items: flex-end; font-size: 1rem; }

        /* ã‚³ãƒãƒ³ãƒ‰ãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ */
        .command-area {
            background: #1a1a1a;
            border-top: 2px solid #444;
            padding: 15px;
            flex-grow: 1; /* ä½™ã£ãŸã‚¹ãƒšãƒ¼ã‚¹ã‚’åŸ‹ã‚ã‚‹ */
            display: flex;
            flex-direction: column;
        }

        .message-box {
            border: 2px solid #555;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 15px;
            min-height: 4em;
            background: #000;
            line-height: 1.5;
            font-size: 1rem;
        }
        .exp-text { color: var(--accent-color); font-size: 0.9em; margin-top: 8px; display: block; border-top: 1px dashed #444; padding-top: 5px;}

        .quiz-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2åˆ—è¡¨ç¤º */
            gap: 10px;
            margin-top: auto; /* ä¸‹å¯„ã› */
        }
        
        /* ã‚¹ãƒãƒ›ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆèª¿æ•´ï¼šé¸æŠè‚¢ãŒé•·ã„å ´åˆã«å‚™ãˆã¦ */
        @media (max-width: 600px) {
             /* å¿…è¦ãªã‚‰ã“ã“ã‚’ 1fr ã«ã™ã‚‹ã¨ãƒœã‚¿ãƒ³ãŒç¸¦ä¸€åˆ—ã«ãªã‚Šã¾ã™ */
            /* grid-template-columns: 1fr; */
        }

        .quiz-btn {
            background: #2a2a2a;
            color: #eee;
            border: 2px solid #555;
            padding: var(--btn-padding);
            font-family: inherit;
            font-size: 1rem;
            cursor: pointer;
            text-align: left;
            transition: all 0.1s;
            border-radius: 6px;
            touch-action: manipulation; /* ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—æ‹¡å¤§é˜²æ­¢ */
        }
        .quiz-btn:active { background: #555; transform: scale(0.98); }
        .quiz-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .quiz-btn.correct-mark { background: #151 !important; border-color: #4f4 !important; }
        .quiz-btn.wrong-mark { background: #511 !important; border-color: #f44 !important; }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é¡ */
        @keyframes damage {
            0% { transform: translate(0, 0); filter: brightness(1); }
            20% { transform: translate(-8px, 2px); filter: brightness(3) sepia(1) hue-rotate(-50deg) saturate(5); }
            40% { transform: translate(8px, -2px); }
            100% { transform: translate(0, 0); filter: brightness(1); }
        }
        .anim-damage { animation: damage 0.4s; }

        @keyframes float-up {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-40px); opacity: 0; }
        }
        .pop-text {
            position: absolute;
            font-weight: bold;
            font-size: 2rem;
            pointer-events: none;
            animation: float-up 1.0s forwards;
            z-index: 10;
            text-shadow: 2px 2px 0 #000;
        }

        /* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ç”»é¢ */
        .overlay {
            position: absolute; inset: 0;
            background: rgba(0,0,0,0.92);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
            text-align: center;
            padding: 20px;
        }
        .btn-start {
            margin-top: 30px;
            padding: 15px 50px;
            font-size: 1.5rem;
            background: #fff;
            color: #000;
            border: none;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            border-radius: 50px; /* ä¸¸ã¿ã‚’ã¤ã‘ã‚‹ */
        }
        .btn-start:active { transform: scale(0.95); background: #ccc; }

    </style>
</head>
<body>

<div class="game-window">
    <div class="header-info">
        <span id="floor-idx">Floor 1</span>
        <span>Eè³‡æ ¼ æ”»ç•¥ã®å¡” V3</span>
    </div>

    <div class="battle-scene" id="scene">
        <div class="enemy-area">
            <div class="enemy-info">
                <div class="enemy-name" id="e-name">Loading...</div>
                <div class="hp-container"><div class="hp-bar hp-red" id="e-hp"></div></div>
            </div>
            <div class="enemy-sprite" id="e-img">ğŸ‘¾</div>
        </div>

        <div class="player-area">
            <div class="player-stats">
                <span>You (Lv.<span id="p-lv">1</span>)</span>
                <span id="p-hp-text">HP: 100</span>
            </div>
            <div class="hp-container" style="width:100%; margin-top:5px;">
                <div class="hp-bar hp-green" id="p-hp"></div>
            </div>
        </div>
    </div>

    <div class="command-area">
        <div class="message-box" id="msg"></div>
        <div class="quiz-grid" id="quiz-box"></div>
    </div>

    <div class="overlay" id="title-screen">
        <h1 style="font-size: clamp(3rem, 10vw, 4rem); margin:0; color:#4db8ff; text-shadow:0 0 20px #00f;">Eè³‡æ ¼<br>æ”»ç•¥ã®å¡”</h1>
        <p>ã‚¹ãƒãƒ›å®Œå…¨å¯¾å¿œ / çŸ¥è­˜ã§ç™»ã‚Šè©°ã‚ã‚</p>
        <button class="btn-start" onclick="startGame()">START</button>
    </div>

    <div class="overlay" id="result-screen" style="display:none;">
        <h1 id="res-title">YOU DIED</h1>
        <p id="res-msg">...</p>
        <button class="btn-start" onclick="location.reload()">RETRY</button>
    </div>
</div>

<script>
// === å•é¡Œãƒ‡ãƒ¼ã‚¿ (æ‹¡å¼µå¯èƒ½) ===
const DB = [
    { c: 'math', q: 'è¡Œåˆ—Aã®å›ºæœ‰å€¤ã‚’Î»ã€å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’xã¨ã—ãŸæ™‚ã€æˆã‚Šç«‹ã¤å¼ã¯ï¼Ÿ', a: ['Ax = Î»x', 'Ax = x + Î»', 'A = Î»x', 'x = AÎ»'], exp: 'å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®å®šç¾©å¼ã§ã™ã€‚ç·šå½¢ä»£æ•°ã®åŸºæœ¬ã§ã™ã€‚' },
    { c: 'math', q: 'ãƒ™ã‚¤ã‚ºã®å®šç† P(A|B) = ?', a: ['P(B|A)P(A)/P(B)', 'P(A|B)P(B)/P(A)', 'P(A)P(B)', 'P(A)+P(B)'], exp: 'äº‹å¾Œç¢ºç‡ã¯ã€Œå°¤åº¦Ã—äº‹å‰ç¢ºç‡Ã·å‘¨è¾ºå°¤åº¦ã€ã§æ±‚ã¾ã‚Šã¾ã™ã€‚' },
    { c: 'ml', q: 'é©åˆç‡(Precision)ã®è¨ˆç®—å¼ã¯ï¼Ÿ(TP:çœŸé™½æ€§, FP:å½é™½æ€§)', a: ['TP / (TP + FP)', 'TP / (TP + FN)', 'TP / (TP + TN)', '2TP / (TP + FP)'], exp: 'ã€Œé™½æ€§ã¨äºˆæ¸¬ã—ãŸã‚‚ã®ã®ã†ã¡ã€å®Ÿéš›ã«é™½æ€§ã ã£ãŸå‰²åˆã€ã§ã™ã€‚' },
    { c: 'ml', q: 'k-meansæ³•ã¯ã©ã®å­¦ç¿’æ‰‹æ³•ã«åˆ†é¡ã•ã‚Œã‚‹ï¼Ÿ', a: ['æ•™å¸«ãªã—å­¦ç¿’', 'æ•™å¸«ã‚ã‚Šå­¦ç¿’', 'å¼·åŒ–å­¦ç¿’', 'æ·±å±¤å­¦ç¿’'], exp: 'æ­£è§£ãƒ©ãƒ™ãƒ«ã‚’ä½¿ã‚ãšã«ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã†ãŸã‚ã€æ•™å¸«ãªã—å­¦ç¿’ã§ã™ã€‚' },
    { c: 'dl', q: 'æ´»æ€§åŒ–é–¢æ•° ReLU(x) ã®å®šç¾©ã¯ï¼Ÿ', a: ['max(0, x)', '1 / (1 + e^-x)', 'x^2', 'tanh(x)'], exp: 'å…¥åŠ›ãŒ0ä»¥ä¸‹ãªã‚‰0ã€æ­£ãªã‚‰ãã®ã¾ã¾å‡ºåŠ›ã—ã¾ã™ã€‚' },
    { c: 'dl', q: 'å¤šå€¤åˆ†é¡å•é¡Œã®å‡ºåŠ›å±¤ã§é€šå¸¸ä½¿ç”¨ã•ã‚Œã‚‹æ´»æ€§åŒ–é–¢æ•°ã¯ï¼Ÿ', a: ['Softmax', 'Sigmoid', 'ReLU', 'Tanh'], exp: 'å‡ºåŠ›ã‚’ç¢ºç‡åˆ†å¸ƒ(åˆè¨ˆ1)ã«ã™ã‚‹ãŸã‚ã€Softmaxé–¢æ•°ã‚’ä½¿ã„ã¾ã™ã€‚' },
    { c: 'opt', q: 'L2æ­£å‰‡åŒ–(Ridge)ã‚’æå¤±é–¢æ•°ã«åŠ ãˆã‚‹åŠ¹æœã¯ï¼Ÿ', a: ['éå­¦ç¿’ã®æŠ‘åˆ¶', 'ã‚¹ãƒ‘ãƒ¼ã‚¹åŒ–', 'è¨ˆç®—é€Ÿåº¦å‘ä¸Š', 'å‹¾é…æ¶ˆå¤±å¯¾ç­–'], exp: 'é‡ã¿ã®å€¤ãŒå¤§ãããªã‚Šã™ããªã„ã‚ˆã†ã«ãƒšãƒŠãƒ«ãƒ†ã‚£ã‚’ä¸ãˆã¾ã™ã€‚' },
    { c: 'opt', q: 'Adamã®ç‰¹å¾´ã¯ï¼Ÿ', a: ['Momentumã¨RMSPropã®çµ„ã¿åˆã‚ã›', 'å­¦ç¿’ç‡å›ºå®š', 'æœ€æ€¥é™ä¸‹æ³•ã¨åŒã˜', 'å¤§åŸŸè§£ã‚’ä¿è¨¼'], exp: 'æ…£æ€§é …ã¨é©å¿œçš„å­¦ç¿’ç‡ã‚’çµ„ã¿åˆã‚ã›ãŸæ‰‹æ³•ã§ã™ã€‚' },
    { c: 'cnn', q: 'CNNã§ä½ç½®ã‚ºãƒ¬ã«å¯¾ã™ã‚‹é ‘å¥æ€§ã‚’ä½œã‚‹å‡¦ç†ã¯ï¼Ÿ', a: ['Pooling', 'Convolution', 'Padding', 'Flatten'], exp: 'ãƒ—ãƒ¼ãƒªãƒ³ã‚°å±¤ã¯å¾®å°ãªä½ç½®å¤‰åŒ–ã‚’å¸åã—ã¾ã™ã€‚' },
    { c: 'cnn', q: 'ResNetã®ç‰¹å¾´çš„ãªæ§‹é€ ã¯ï¼Ÿ', a: ['Skip Connection', 'Inception Module', 'Attention', 'Dropout'], exp: 'å…¥åŠ›ã‚’å‡ºåŠ›ã«è¶³ã—åˆã‚ã›ã‚‹ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆæ§‹é€ ã§ã™ã€‚' },
    { c: 'rnn', q: 'LSTMãŒæŒã¤ã‚²ãƒ¼ãƒˆã«å«ã¾ã‚Œãªã„ã‚‚ã®ã¯ï¼Ÿ', a: ['Attention Gate', 'Input Gate', 'Forget Gate', 'Output Gate'], exp: 'LSTMã¯å…¥åŠ›ãƒ»å¿˜å´ãƒ»å‡ºåŠ›ã®3ã¤ã®ã‚²ãƒ¼ãƒˆã‚’æŒã¡ã¾ã™ã€‚' },
    { c: 'rnn', q: 'Transformerã®ä¸»è¦ãªæ©Ÿæ§‹ã¯ï¼Ÿ', a: ['Self-Attention', 'Convolution', 'LSTM', 'GAN'], exp: 'RNNã‚’ä½¿ã‚ãšã€Attentionã®ã¿ã§ä¸¦åˆ—è¨ˆç®—ã‚’è¡Œã„ã¾ã™ã€‚' },
    { c: 'gen', q: 'GANã«ãŠã‘ã‚‹Generatorã®ç›®çš„ã¯ï¼Ÿ', a: ['Discriminatorã‚’é¨™ã™', 'ç”»åƒã‚’åˆ†é¡ã™ã‚‹', 'ãƒã‚¤ã‚ºã‚’é™¤å»ã™ã‚‹', 'å¼·åŒ–å­¦ç¿’ã™ã‚‹'], exp: 'å½ç‰©ã‚’æœ¬ç‰©ã¨èª¤èªã•ã›ã‚‹ã‚ˆã†ã«å­¦ç¿’ã—ã¾ã™ã€‚' }
];
// â€»å•é¡ŒãŒè¶³ã‚Šãªã„å ´åˆã¯è‡ªå‹•çš„ã«å…¨å•é¡Œã‹ã‚‰è£œå……ã•ã‚Œã¾ã™

const STAGES = [
    { f:1, name:"ç·šå½¢ä»£æ•°", cat:'math', hp:30 },
    { f:2, name:"æ©Ÿæ¢°å­¦ç¿’", cat:'ml', hp:50 },
    { f:3, name:"æ·±å±¤å­¦ç¿’", cat:'dl', hp:60 },
    { f:4, name:"æœ€é©åŒ–", cat:'opt', hp:70 },
    { f:5, name:"ï¼£ï¼®ï¼®", cat:'cnn', hp:80 },
    { f:6, name:"ï¼²ï¼®ï¼®", cat:'rnn', hp:90 },
    { f:7, name:"ç”Ÿæˆãƒ»å¼·åŒ–å­¦ç¿’", cat:'gen', hp:100 },
    { f:8, name:"ï¼ªï¼¤ï¼¬ï¼¡", cat:'boss', hp:150 }
];

let state = { floor: 0, p_hp: 100, p_max: 100, e_hp: 0, e_max: 0, q_list: [], turn: true };
const dom = {
    scr: document.getElementById('title-screen'),
    res: document.getElementById('result-screen'),
    msg: document.getElementById('msg'),
    quiz: document.getElementById('quiz-box'),
    p_hp: document.getElementById('p-hp'),
    e_hp: document.getElementById('e-hp'),
    e_img: document.getElementById('e-img'),
    floor: document.getElementById('floor-idx'),
    e_name: document.getElementById('e-name'),
    scene: document.getElementById('scene')
};

function startGame() {
    state.floor = 0; state.p_hp = state.p_max;
    dom.scr.style.display = 'none'; dom.res.style.display = 'none';
    loadStage();
}

function loadStage() {
    if(state.floor >= STAGES.length) { gameClear(); return; }
    const stg = STAGES[state.floor];
    state.e_max = stg.hp; state.e_hp = stg.hp;
    
    dom.floor.innerText = `F${stg.f} ${stg.name}`;
    dom.e_name.innerText = stg.name;
    dom.e_img.innerText = ['ğŸ¦ ','ğŸº','ğŸ¤–','âš™ï¸','ğŸ‘ï¸','ğŸ‘»','ğŸ²','ğŸ‘‘'][state.floor];
    
    updateBar(dom.e_hp, 100); updateBar(dom.p_hp, (state.p_hp/state.p_max)*100);
    msg(`${stg.name} ãŒã‚ã‚‰ã‚ã‚ŒãŸï¼`);
    
    let list = DB.filter(d => d.c === stg.cat);
    if(list.length < 2 || stg.cat === 'boss') list = DB; // è£œå……
    state.q_list = list.sort(() => Math.random() - 0.5);
    
    setTimeout(nextTurn, 1200);
}

function nextTurn() {
    state.turn = true;
    if(state.q_list.length === 0) state.q_list = DB.sort(() => Math.random() - 0.5); // æ¯æ¸‡å¯¾ç­–
    showQuiz(state.q_list.pop());
}

function showQuiz(q) {
    msg(`Q. ${q.q}`);
    dom.quiz.innerHTML = '';
    let opts = q.a.map((txt, i) => ({ txt, isC: i===0 })).sort(() => Math.random() - 0.5);
    
    opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'quiz-btn';
        btn.innerText = o.txt;
        btn.onclick = () => answer(btn, o.isC, q);
        dom.quiz.appendChild(btn);
    });
}

function answer(btn, isCorrect, qData) {
    if(!state.turn) return; state.turn = false;
    Array.from(dom.quiz.children).forEach(b => b.disabled = true);
    
    if(isCorrect) {
        btn.classList.add('correct-mark');
        msg(`æ­£è§£ï¼<br><span class="exp-text">${qData.exp}</span>`);
        damageEnemy();
    } else {
        btn.classList.add('wrong-mark');
        Array.from(dom.quiz.children).forEach(b => { if(b.innerText === qData.a[0]) b.classList.add('correct-mark'); });
        msg(`ä¸æ­£è§£...<br><span class="exp-text">${qData.exp}</span>`);
        damagePlayer();
    }
}

function damageEnemy() {
    dom.e_img.classList.add('anim-damage');
    showPop(dom.e_img, "10!!", "#ff0");
    state.e_hp -= 10;
    updateBar(dom.e_hp, (state.e_hp/state.e_max)*100);
    if(state.p_hp < state.p_max) { state.p_hp += 5; updateBar(dom.p_hp, (state.p_hp/state.p_max)*100); }
    
    setTimeout(() => {
        dom.e_img.classList.remove('anim-damage');
        if(state.e_hp <= 0) { msg("æ•µã‚’å€’ã—ãŸï¼"); setTimeout(() => { state.floor++; loadStage(); }, 1500); }
        else setTimeout(nextTurn, 2000);
    }, 500);
}

function damagePlayer() {
    dom.scene.classList.add('anim-damage');
    showPop(dom.scene, "20 Dmg!", "#f00");
    state.p_hp -= 20;
    updateBar(dom.p_hp, (state.p_hp/state.p_max)*100);
    setTimeout(() => {
        dom.scene.classList.remove('anim-damage');
        if(state.p_hp <= 0) gameOver();
        else setTimeout(nextTurn, 2000);
    }, 500);
}

function updateBar(el, per) { el.style.width = Math.max(0, per) + "%"; document.getElementById('p-hp-text').innerText = `HP: ${state.p_hp}`; }
function msg(html) { dom.msg.innerHTML = html; }
function showPop(target, text, color) {
    const rect = target.getBoundingClientRect();
    const el = document.createElement('div'); el.innerText = text; el.className = 'pop-text';
    el.style.color = color; el.style.left = (rect.left + rect.width/2 - 20) + 'px'; el.style.top = (rect.top) + 'px';
    document.body.appendChild(el); setTimeout(() => el.remove(), 1000);
}
function gameOver() { dom.res.style.display = 'flex'; dom.res.querySelector('h1').innerText = "GAME OVER"; dom.res.querySelector('p').innerText = "å†æŒ‘æˆ¦ã—ã‚ˆã†"; }
function gameClear() { dom.res.style.display = 'flex'; dom.res.querySelector('h1').innerText = "åˆæ ¼!!"; dom.res.querySelector('h1').style.color = "#ff0"; dom.res.querySelector('p').innerText = "å›ãªã‚‰Eè³‡æ ¼ã«å—ã‹ã‚‹ï¼"; }
</script>
</body>
</html>